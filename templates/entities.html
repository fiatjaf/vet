{% extends 'base.html' %}

{% block body %}

<h1><a href="/">Início</a> / <a href="/{{ table_name }}/">{{ table_name | replace('-', ' ') | title }}</a></h1>

<table>
  <tr>
    <th></th>
    {% for name, column in columns.items() %}
      <th>{{ name }}</th>
    {% endfor %}
  </tr>
    {% for row in rows %}
    <tr>
      <td>
        {% if primary_key %}
        <a href="/{{ table_name }}/{{ row[columns.keys().index(primary_key)] }}">VER</a>
        {% endif %}
      </td>
      {% for item in row %}
        <td>
          {% if item and columns.keys()[loop.index0] in foreign_keys %}
            {% set foreign_key = foreign_keys[columns.keys()[loop.index0]] %}
            {% set foreign_key_table = foreign_key.table %}
            {% set foreign_key_column = foreign_key.column %}
            <a href="/{{ tablenames[foreign_key_table] }}/{{ item }}">
              {{ item | fk2name(table=foreign_key_table, column=foreign_key_column) }}
            </a>
          {% else %}
            {{ item }}
          {% endif %}
        </td>
      {% endfor %}
    </tr>
    {% endfor %}
  </tr>
</table>

<form method="get" action="{{ request.url | add_query_params({'from': offset + limit}) }}">
  <input value="{{ limit }}" name="show" size=2>
  <button type="submit">por página</button>
</form>
<a href="{{ request.url | add_query_params({'from': offset + limit}) }}">próxima</a>

{% endblock %}
